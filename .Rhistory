t1 %>%
collapse_telem() %>%
multcomp_telem(DegC ~ Group, collapse_first = T, plot_or_table = "table")
View(multcomp)
t1 %>%
collapse_telem() %>%
collapse_telem()
View(t)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
t1 %>%
collapse_telem() %>%
collapse_telem()
t1 %>%
collapse_telem() %>%
multcomp_telem(DegC ~ Group, collapse_first = T, plot_or_table = "table")
t1 %>%
collapse_telem() %>%
multcomp_telem(DegC ~ Group, collapse_first = T, plot_or_table = "plot")
relco_oddi_2 %>%
fuzz_telem("15 minute") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = F)
relco_oddi_2 %>%
fuzz_telem("15 minute") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX")
relco_oddi_2 %>%
fuzz_telem("15 minute") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
relco_oddi_2 %>%
fuzz_telem("15 minute") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
#fuzz_telem("15 minute") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("30 minute") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("60 minute") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("2 hours") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("4 hours") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("1 hours") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("1 hours") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
fuzz_telem("30 minutes") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
fuzz_telem("30 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
fuzz_telem("15 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
fuzz_telem("30 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
fuzz_telem("30 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("15 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("10 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("5 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("60 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
multcomp_telem(DegC ~ x_factor, collapse_first = T)
relco_oddi_2 %>%
fuzz_telem("60 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
fuzz_telem("10 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
fuzz_telem("10 minutes") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
#trim_telem(keep_groups = "TMX") %>%
#multcomp_telem(DegC ~ x_factor, collapse_first = T)
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
#trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
multcomp_telem(DegC ~ x_factor, collapse_first = T)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
multcomp_telem(DegC ~ x_factor, collapse_first = F)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
multcomp_telem(DegC ~ x_factor)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368,899") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
#graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
multcomp_telem(DegC ~ x_factor)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368,899") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
relco_oddi_2 %>%
graph_telem(group_by = "Group", one_day_avg = T)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368,899") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
tmx.telem.2 %>%
graph_telem(group_by = "Group", one_day_avg = T)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-24 00:00:00", day_2_start = "2020-02-25 00:00:00", xover_var = "L368,899") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
tmx.telem.2 %>%
graph_telem(group_by = "Group", one_day_avg = T)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
x_factor_telem("Group", "Xover") %>%
trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
library(Seurat)
packageVersion("Seurat")
male1.data <- as.matrix(read.csv("~/Dropbox/van Veen dropbox/Single Cell/d701PC.csv", row.names = 1))
male2.data <- as.matrix(read.csv("~/Dropbox/van Veen dropbox/Single Cell/d710PC.csv", row.names = 1))
male3.data <- as.matrix(read.csv("~/Dropbox/van Veen dropbox/Single Cell/MRmale1PC.csv", row.names = 1))
female1.data <- as.matrix(read.csv("~/Dropbox/van Veen dropbox/Single Cell/d709PC.csv", row.names = 1))
female2.data <- as.matrix(read.csv("~/Dropbox/van Veen dropbox/Single Cell/MRfem1PC.csv", row.names = 1))
female3.data <- as.matrix(read.csv("~/Dropbox/van Veen dropbox/Single Cell/MRfem2PC.csv", row.names = 1))
male1 <- CreateSeuratObject(raw.data = male1.data, min.cells = 2, min.genes = 250, project = "m1_singles")
male2 <- CreateSeuratObject(raw.data = male2.data, min.cells = 2, min.genes = 250, project = "m2_singles")
male3 <- CreateSeuratObject(raw.data = male3.data, min.cells = 2, min.genes = 250, project = "m3_singles")
female1 <- CreateSeuratObject(raw.data = female1.data, min.cells = 2, min.genes = 250, project = "f2_singles")
female2 <- CreateSeuratObject(raw.data = female2.data, min.cells = 2, min.genes = 250, project = "f3_singles")
female3 <- CreateSeuratObject(raw.data = female3.data, min.cells = 2, min.genes = 250, project = "f4_singles")
male <- MergeSeurat(object1 = male1, object2 = male2, add.cell.id1 = "m1", add.cell.id2 = "m2", project = "m_singles")
table(male@meta.data$orig.ident)
male <- MergeSeurat(object1 = male, object2 = male3, add.cell.id2 = "m3", project = "m_singles")
female <- MergeSeurat(object1 = female1, object2 = female2, add.cell.id1 = "f1", add.cell.id2 = "f2", project = "f_singles")
female <- MergeSeurat(object1 = female, object2 = female3, add.cell.id2 = "f3", project = "f_singles")
male@meta.data$sex <- "Male"
library(tidyverse)
library(lubridate)
library(telemR)
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
knitr::opts_chunk$set(echo = TRUE)
my.meta.data <- tibble("TMX" = c("54_2934", "52_3065", "48_3061", "50_3063"),
"VEH" = c("53_3066", "55_2936", "49_3062", "51_3064"))
tmx.telem <- read_starr(raw_asc = "~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = my.meta.data)
library(tidyverse)
library(cowplot)
library(telemR)
my.meta.data <- tibble("TMX" = c("54_2934", "52_3065", "48_3061", "50_3063"),
"VEH" = c("53_3066", "55_2936", "49_3062", "51_3064"))
tmx.telem <- read_starr(raw_asc = "~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = my.meta.data)
meta.data <- tibble("TMX" = c("48t", "50t", "52t", "54t"),
"VEH" = c("49t", "51t", "53t", "55t"))
meta.data <- tibble("TMX" = c("54_2934", "52_3065", "48_3061", "50_3063"),
"VEH" = c("53_3066", "55_2936", "49_3062", "51_3064"))
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data, meta_data_xover = xovers, meta_data_sex = sex)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
library(telemR)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data_group = meta.data)
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data_group = meta.data)
View(tmx.telem)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
meta.data <- tibble("TMX" = c("48t", "50t", "52t", "54t"),
"VEH" = c("49t", "51t", "53t", "55t"))
relco_oddi <- read_oddi("~/Dropbox/JEV/Zhi single cell paper/telemetry/", meta_data_group = meta.data)
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
relco_oddi <- read_oddi("~/Dropbox/JEV/Zhi single cell paper/telemetry/", meta_data_group = meta.data)
View(relco_oddi)
View(tmx.telem)
View(tmx.telem)
graph_telem(tidy_telem = tmx.telem)
tinytex::install_tinytex()
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
t1 <- as.POSIXct(paste0("2020-01-19", " ", "23:55:55"))
t2 <- as.POSIXct(paste0("2020-01-24", " ", "23:55:55"))
tdiff <- t1 - t2
tdiff
t2 + tdiff
tdiff <- t2 - t1
t1 + tdiff
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
t1 <- tmx.telem %>%
trim_telem(start_time = "2020-01-15 00:00:00", end_time = "2020-01-20 00:00:00")
t2 <- tmx.telem %>%
trim_telem(start_time = "2020-01-04 00:00:00", end_time = "2020-01-09 00:00:00")
t1 <- tmx.telem %>%
trim_telem(start_time = "2020-01-15 00:00:00", end_time = "2020-01-20 00:00:00") %>%
graph_telem(group_by = "Group")
t2 <- tmx.telem %>%
trim_telem(start_time = "2020-01-04 00:00:00", end_time = "2020-01-09 00:00:00") %>%
graph_telem(group_by = "Group")
plot_grid(t1,t2)
t1 <- tmx.telem %>%
trim_telem(start_time = "2020-01-04 00:00:00", end_time = "2020-01-09 00:00:00")
t2 <- tmx.telem %>%
trim_telem(start_time = "2020-01-15 00:00:00", end_time = "2020-01-20 00:00:00")
p1 <- tmx.telem %>%
trim_telem(start_time = "2020-01-04 00:00:00", end_time = "2020-01-09 00:00:00") %>%
graph_telem(group_by = "Group")
p2 <- tmx.telem %>%
trim_telem(start_time = "2020-01-15 00:00:00", end_time = "2020-01-20 00:00:00") %>%
graph_telem(group_by = "Group")
p3 <- combine_telem(t1, t2) %>%
graph_telem(group_by = "Group")
plot_grid(p1, p2, p3)
plot_grid(p1, p2, p3)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
my.meta.data <- tibble("TMX" = c("54_2934", "52_3065", "48_3061", "50_3063"),
"VEH" = c("53_3066", "55_2936", "49_3062", "51_3064"))
tmx.telem <- read_starr(raw_asc = "~/Box/Tamoxifen Paper/zz157jev.asc",
meta_data_group = my.meta.data)
tmx.telem <- read_starr(raw_asc = "~/Box/Tamoxifen Paper/zz157jev.asc",
meta_data_group = my.meta.data, trim_na = F)
sex <- tibble("F" = c("54_2934", "52_3065", "53_3066", "55_2936",
"48_3061", "50_3063","49_3062", "51_3064"))
xovers <- tibble("A" = c("54_2934", "52_3065", "53_3066", "55_2936"),
"B" = c("48_3061", "50_3063","49_3062", "51_3064"))
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc",
meta_data_group = my.meta.data, meta_data_xover = xovers,
meta_data_sex = sex)
tmx.telem
xovers <- tibble("A" = c("52t", "53t", "54t", "55t"),
"B" = c("48t", "49t", "50t", "51t"))
meta.data <- tibble("TMX" = c("48t", "50t", "52t", "54t"),
"VEH" = c("49t", "51t", "53t", "55t"))
sex <- tibble("F" = c("52t", "53t", "54t", "55t",
"48t", "49t", "50t", "51t"))
tmx.oddi <- read_oddi("~/Dropbox/JEV/Zhi single cell paper/telemetry/",
meta_data_group = meta.data)
export_telem(tidy_telem = tmx.telem, filename = "~/Desktop/myfilename.xlsx")
graph_telem(tidy_telem = tmx.telem)
align_telem(t1, t2, align_date_1 = "2020-01-04", align_date_2 = "2020-01-15")
align_telem(t1, t2, align_date_1 = "2020-01-04", align_date_2 = "2020-01-15") %>%
graph_telem(group_by = "Group")
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
first_time(t1)
first_time(t1$Time)
first_time(t1$Time) %>% day()
first_time(t1$Time) %>% date()
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
align_telem(t1, t2, align_date_1 = "2020-01-04", align_date_2 = "2020-01-15") %>%
graph_telem(group_by = "Group")
align_telem(t1, t2, align_date_1 = "2020-01-05", align_date_2 = "2020-01-15") %>%
graph_telem(group_by = "Group")
align_telem(t1, t2, align_date_1 = "2020-01-07", align_date_2 = "2020-01-15") %>%
graph_telem(group_by = "Group")
align_telem(t1, t2, align_date_2 = "2020-01-15") %>%
graph_telem(group_by = "Group")
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
#x_factor_telem("Group", "Xover") %>%
#trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
View(tmx.telem.2)
xovers <- tibble("A" = c("54_2934", "52_3065", "53_3066", "55_2936"), "B" = c("48_3061", "50_3063","49_3062", "51_3064"))
meta.data <- tibble("TMX" = c("54_2934", "52_3065", "48_3061", "50_3063"),
"VEH" = c("53_3066", "55_2936", "49_3062", "51_3064"))
sex <- tibble("F" = c("54_2934", "52_3065", "53_3066", "55_2936", "48_3061", "50_3063","49_3062", "51_3064"))
tmx.telem.2 <- read_starr("~/Dropbox/JEV/telemetry/zz161.asc", meta_data_group = meta.data, trim_na = F, meta_data_xover = xovers, meta_data_sex = sex)
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
#x_factor_telem("Group", "Xover") %>%
#trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "x_factor", one_day_avg = F, telem_var = "DegC")
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco")
tmx.telem.2 %>%
fuzz_telem("15 min") %>%
x_over_telem(day_1_start = "2020-02-27 00:00:00", day_2_start = "2020-02-28 00:00:00", xover_var = "Relco") %>%
#x_factor_telem("Group", "Xover") %>%
#trim_telem(keep_groups = "TMX") %>%
graph_telem(group_by = "Xover", one_day_avg = F, telem_var = "DegC")
source('~/Dropbox/JEV/R/telemR/R/telemR.R')
library(telemR)
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
read_telem_excel <- function(excel_file, telem_var, sheet = 1, skip = 0,
pattern_1, group_1, pattern_2, group_2){
tryCatch({
temp <- readxl::read_excel(excel_file, sheet = sheet, skip = skip) %>%
mutate(Time = paste0(Date, " ", Time)) %>%
select(-Date) %>%
pivot_longer(-Time, names_to = "Mouse", values_to = telem_var) %>%
mutate(Group = ifelse(grepl(pattern_1, Mouse), group_1, group_2))
temp$Time <- as.POSIXct(temp$Time)
temp$Group <- as.factor(temp$Group)
temp$Mouse <- as.factor(temp$Mouse)
return(temp)
}, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})
}
#for graphing, this vector is the colors in the paper
torpor_colors <- c("#FF40FE", "Black")
#read inputs into tidy format
tcore1 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 1, telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
#read inputs into tidy format
tcore1 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 1, telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
tcore2 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 3, telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
act1 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 2, telem_var = "Counts",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
act2 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 4, telem_var = "Counts",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
act2 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 4, telem_var = "Counts",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
tcore2 <- fuzz_telem(tcore2, output_window = "1 hour", telem_var = "DegC")
tcore2 <- fuzz_telem(tcore2, output_window = "1 hour")
#add counts to tcore files
tcore1$Counts <- act1$Counts
tcore2$Counts <- act2$Counts
#graphs. cut values when animals start to disappear in expt. 1
p1 <- tcore1 %>%
trim_telem(end_time = "1978-10-04 12:00:00") %>%
fuzz_telem("60 minutes") %>%
graph_telem(telem_var = "DegC", group_by = "Group") +
scale_fill_manual(values = torpor_colors) +
scale_color_manual(values = torpor_colors) +
theme(axis.text.x=element_blank()) +
labs(color = "Injection")
p2 <- tcore1 %>%
trim_telem(end_time = "1978-10-04 12:00:00") %>%
fuzz_telem("60 minutes") %>%
graph_telem(telem_var = "Counts", group_by = "Group") +
scale_fill_manual(values = torpor_colors) +
scale_color_manual(values = torpor_colors) +
theme(axis.text.x=element_blank()) +
labs(color = "Injection")
p3 <- tcore2 %>%
graph_telem(telem_var = "DegC", group_by = "Group") +
scale_fill_manual(values = torpor_colors) +
scale_color_manual(values = torpor_colors) +
theme(axis.text.x=element_blank()) +
labs(color = "Injection")
p4 <- tcore2 %>%
graph_telem(telem_var = "Counts", group_by = "Group") +
scale_fill_manual(values = torpor_colors) +
scale_color_manual(values = torpor_colors) +
theme(axis.text.x=element_blank()) +
labs(color = "Injection")
plot_grid(p1, p2)
library(telemR)
