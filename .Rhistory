library(telemR)
roxygen2::roxygenise()
roxygen2::roxygenise()
library(telemR)
library(telemR)
tmx.telem.2 <- read_starr("~/Dropbox/JEV/telemetry/zz161.asc", meta_data = meta.data, trim_na = T)
library(tidyverse)
library(lubridate)
library(cowplot)
tmx.telem.2 <- read_starr("~/Dropbox/JEV/telemetry/zz161.asc", meta_data = meta.data, trim_na = T)
meta.data <- tibble("TMX" = c("54_2934", "52_3065", "48_3061", "50_3063"),
"VEH" = c("53_3066", "55_2936", "49_3062", "51_3064"))
tmx.telem.2 <- read_starr("~/Dropbox/JEV/telemetry/zz161.asc", meta_data = meta.data, trim_na = T)
p1 <- tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39) +
p2 <- tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
p1 <- tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39) +
p2 <- tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
p12 <- plot_grid(p1, p2)
p1 <- tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39) +
tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
View(tmx.telem.2)
p1 <- tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39) +
tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
p1 <- tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39)
p2 <- tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
p12 <- plot_grid(p1, p2)
p12 <- plot_grid(p1, p2)
p1 <- tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39)
p2 <- tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
p12 <- plot_grid(p1, p2)
dev.off()
dev.off()
p12 <- plot_grid(p1, p2)
tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39)
p1 <- tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39)
p2 <- tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = F, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
p12 <- plot_grid(p1, p2)
tmx.telem.2 %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = T, telem_var = "DegC") + geom_hline(yintercept = 36) + ylim(35,39)
tmx.telem %>%
fuzz_telem("30 min") %>%
graph_telem(group_by = "Group", one_day_avg = T, telem_var = "DegC", tx_time = c("2020-01-14 12:05:00", "2020-01-15 12:05:00")) +
geom_hline(yintercept = 36) +
ylim(35,39)
library(telemR)
roxygen2::roxygenise()
roxygen2::roxygenise()
man fuzz_telem()
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
meta.data <- tibble("TMX" = c("54_2934", "52_3065", "48_3061", "50_3063"),
"VEH" = c("53_3066", "55_2936", "49_3062", "51_3064"))
relco_oddi <- read_oddi("~/Dropbox/JEV/Zhi single cell paper/telemetry/", meta_data = meta.data)
tmx.telem <- read_starr("~/Box/Tamoxifen Paper/zz157jev.asc", meta_data = meta.data)
relco_tx <- read_starr("~/Dropbox/JEV/telemetry/zz159.asc", meta_data = meta.data, trim_na = T)
tmx.telem %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
devtools::load_all("~/telemR/")
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
meta.data <- tibble("TMX,1" = c("54_2934", "52_3065"), "TMX,2" = c("48_3061", "50_3063"),
"VEH,1" = c("53_3066", "55_2936"), "VEH,2" = c("49_3062", "51_3064"))
relco_oddi <- read_oddi("~/Dropbox/JEV/Zhi single cell paper/telemetry/", meta_data = meta.data)
meta.data <- tibble("TMX" = c("48t", "50t", "52t", "54t"),
"VEH" = c("49t", "51t", "53t", "55t"))
relco_oddi <- read_oddi("~/Dropbox/JEV/Zhi single cell paper/telemetry/", meta_data = meta.data)
relco_oddi %>%
fuzz_telem(output_window = "60 minutes", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "10 minutes", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "10 minutes", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = F)
file.exists("~/.ssh/id_rsa.pub")
relco_oddi %>%
fuzz_telem(output_window = "10 minutes", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = F, one_day_avg = F)
relco_oddi %>%
fuzz_telem(output_window = "10 minutes", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "1 minutes", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "5 minutes", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "3 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "2 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "1 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "2 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "3 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "4 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "5 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "6 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
relco_oddi %>%
fuzz_telem(output_window = "1 hours", telem_var = "DegC") %>%
graph_telem(group_by = "Group", se_ribbon = T, one_day_avg = T)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx", skip = 1)
View(temp)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx", skip = 0)
View(temp)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx")
View(temp)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx")
View(temp)
library(tidyverse)
library(lubridate)
library(cowplot)
library(telemR)
pivot_longer(temp)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx")
temp %>%
pivot_longer(-Time, names_to = "Mouse", values_to = "DegC")
temp <- temp %>%
pivot_longer(-Time, names_to = "Mouse", values_to = "DegC")
View(temp)
grepl(c, temp$Mouse)
grepl("c", temp$Mouse)
if(grepl("c", temp$Mouse)){temp$Group <- "CNO"}
if(T){return("CNO")}
function(){if(T){return("CNO")}}
f <- function(){if(T){return("CNO")}}
f()
f <- function(){if(grepl("c", temp$Mouse)){return("CNO")}}
f()
f <- function(){if(grepl("c", temp$Mouse)){return("CNO")}else{return("SAL")}}
temp$Group <- f(temp$Mouse)
f <- function(where){if(grepl("c", where)){return("CNO")}else{return("SAL")}}
temp$Group <- f(temp$Mouse)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx")
temp <- temp %>%
pivot_longer(-Time, names_to = "Mouse", values_to = "DegC")
f <- function(where){if(grepl("c", where)){return("CNO")}else{return("SAL")}}
temp <- temp %>%
mutate(Group = f(Mouse))
View(temp)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx")
temp <- temp %>%
pivot_longer(-Time, names_to = "Mouse", values_to = "DegC")
temp <- temp %>%
mutate(Group = ifelse(grepl("c", where), "CNO", "SAL"))
temp <- temp %>%
mutate(Group = ifelse(grepl("c", Mouse), "CNO", "SAL"))
View(temp)
f <- function(where){ifelse(grepl("c", where), "CNO", "SAL")}
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx")
temp <- temp %>%
pivot_longer(-Time, names_to = "Mouse", values_to = "DegC")
temp <- temp %>%
mutate(Group = f(Mouse))
View(temp)
View(temp)
read_excel
readxl::read_excel
read_telem_excel <- function(excel_file, telem_var, sheet = 1, skip = 0,
pattern_1, group_1, pattern_2, group_2){
temp <- readxl::read_excel(excel_file, sheet = sheet, skip = skip) %>%
pivot_longer(-Time, names_to = "Mouse", values_to = telem_var) %>%
mutate(Group = ifelse(grepl(pattern_1, Mouse), group_1, group_2))
}
rm(temp)
temp <- readxl::read_excel("~/Desktop/Torpor_stats.xlsx")
View(temp)
temp <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
View(temp)
tcore1 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
read_telem_excel <- function(excel_file, telem_var, sheet = 1, skip = 0,
pattern_1, group_1, pattern_2, group_2){
temp <- readxl::read_excel(excel_file, sheet = sheet, skip = skip) %>%
pivot_longer(-Time, names_to = "Mouse", values_to = telem_var) %>%
mutate(Group = ifelse(grepl(pattern_1, Mouse), group_1, group_2))
temp$Time <- as.POSIXct(temp$Time)
}
temp <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
View(temp)
read_telem_excel <- function(excel_file, telem_var, sheet = 1, skip = 0,
pattern_1, group_1, pattern_2, group_2){
temp <- readxl::read_excel(excel_file, sheet = sheet, skip = skip) %>%
pivot_longer(-Time, names_to = "Mouse", values_to = telem_var) %>%
mutate(Group = ifelse(grepl(pattern_1, Mouse), group_1, group_2))
temp$Time <- as.factor(temp$Time)
}
temp <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
temp
read_telem_excel <- function(excel_file, telem_var, sheet = 1, skip = 0,
pattern_1, group_1, pattern_2, group_2){
temp <- readxl::read_excel(excel_file, sheet = sheet, skip = skip) %>%
pivot_longer(-Time, names_to = "Mouse", values_to = telem_var) %>%
mutate(Group = ifelse(grepl(pattern_1, Mouse), group_1, group_2))
temp$Time <- as.factor(temp$Time)
return(temp)
}
temp <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
temp
read_telem_excel <- function(excel_file, telem_var, sheet = 1, skip = 0,
pattern_1, group_1, pattern_2, group_2){
temp <- readxl::read_excel(excel_file, sheet = sheet, skip = skip) %>%
pivot_longer(-Time, names_to = "Mouse", values_to = telem_var) %>%
mutate(Group = ifelse(grepl(pattern_1, Mouse), group_1, group_2))
temp$Time <- as.factor(temp$Time)
temp$Group <- as.factor(temp$Group)
return(temp)
}
temp <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
temp
read_telem_excel <- function(excel_file, telem_var, sheet = 1, skip = 0,
pattern_1, group_1, pattern_2, group_2){
temp <- readxl::read_excel(excel_file, sheet = sheet, skip = skip) %>%
pivot_longer(-Time, names_to = "Mouse", values_to = telem_var) %>%
mutate(Group = ifelse(grepl(pattern_1, Mouse), group_1, group_2))
temp$Time <- as.factor(temp$Time)
temp$Group <- as.factor(temp$Group)
temp$Mouse <- as.factor(temp$Mouse)
return(temp)
}
temp <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
temp
tcore1 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
tcore2 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 3, telem_var = "DegC",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
act1 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 2, telem_var = "Counts",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
act2 <- read_telem_excel("~/Desktop/Torpor_stats.xlsx", sheet = 4, telem_var = "Counts",
pattern_1 = "c", group_1 = "CNO", pattern_2 = "s", group_2 = "SAL")
graph_telem(tcore1)
graph_telem(tcore1, one_day_avg = T)
View(act1)
temp$Time
temp$Time %>% as.POSIXct()
temp$Time %>% as.POSIXct(origin = 1970)
temp$Time %>% as.POSIXct(origin = "2020-01-01 00:00:00")
hms(temp$Time)
ggplot(data = tcore1, aes(x = Time, y = DegC)) +
geom_point()
ggplot(data = tcore1, aes(x = Time, y = DegC, color = Group)) +
geom_point()
ggplot(data = tcore1, aes(x = Time, y = DegC, color = Group, group = Group)) +
stat_summary(geom="line", fun.y=mean)
ggplot(data = tcore1, aes(x = Time, y = DegC, color = Group, group = Group)) +
stat_summary(geom="line", fun.y=mean) +
scale_x_discrete(breaks = c("07:00", "13:00", "19:00")) +
stat_summary(geom="ribbon", fun.data = mean_se, aes(fill = Group), alpha = .5, color = NA, show.legend = F)
ggplot(data = tcore1, aes(x = Time, y = DegC, color = Group, group = Group)) +
stat_summary(geom="line", fun.y=mean) +
stat_summary(geom="ribbon", fun.data = mean_se, aes(fill = Group), alpha = .5, color = NA, show.legend = F)
ggplot(data = tcore2, aes(x = Time, y = DegC, color = Group, group = Group)) +
stat_summary(geom="line", fun.y=mean) +
stat_summary(geom="ribbon", fun.data = mean_se, aes(fill = Group), alpha = .5, color = NA, show.legend = F)
ggplot(data = act1, aes(x = Time, y = Counts, color = Group, group = Group)) +
stat_summary(geom="line", fun.y=mean) +
stat_summary(geom="ribbon", fun.data = mean_se, aes(fill = Group), alpha = .5, color = NA, show.legend = F)
basemjev <- formula(paste0(telem_var," ~ 1"))
groupmjev <- formula(paste0(telem_var," ~ Group"))
baseline <- nlme::lme(DegC ~ 1, random = ~1 | Mouse/Group, data = tcore1, method = "ML")
baseline <- nlme::lme(DegC ~ 1, random = ~1 | Mouse/Group, data = tcore2, method = "ML")
Group <- nlme::lme(DegC ~ Group, random = ~1 | Mouse/Group, data = tcore2, method = "ML")
View(tcore1)
baseline <- nlme::lme(DegC ~ 1, random = ~1 | Mouse/Group, data = tcore2, method = "REML")
ggplot(data = tcore2, aes(x = Time, y = DegC, color = Group, group = Group)) +
stat_summary(geom="line", fun.y=mean) +
stat_summary(geom="ribbon", fun.data = mean_se, aes(fill = Group), alpha = .5, color = NA, show.legend = F)
ggplot(data = act1, aes(x = Time, y = Counts, color = Group, group = Group)) +
stat_summary(geom="line", fun.y=mean) +
stat_summary(geom="ribbon", fun.data = mean_se, aes(fill = Group), alpha = .5, color = NA, show.legend = F)
